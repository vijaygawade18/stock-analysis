/**
 * @license NgRx 7.4.0
 * (c) 2015-2018 Brandon Roberts, Mike Ryan, Rob Wormald, Victor Savkin
 * License: MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/router"),require("@ngrx/store"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@ngrx/router-store",["exports","@angular/core","@angular/router","@ngrx/store","rxjs/operators"],e):e(((t=t||self).ngrx=t.ngrx||{},t.ngrx.routerStore={}),t.ng.core,t.ng.router,t["@ngrx/store"],t.rxjs.operators)}(this,function(t,e,r,o,i){"use strict";var n,a="@ngrx/router-store/error",s=function s(){},u=function(){function t(){}return t.prototype.serialize=function(t){return{root:this.serializeRoute(t.root),url:t.url}},t.prototype.serializeRoute=function(t){var e=this,r=t.children.map(function(t){return e.serializeRoute(t)});return{params:t.params,paramMap:t.paramMap,data:t.data,url:t.url,outlet:t.outlet,routeConfig:t.routeConfig?{component:t.routeConfig.component,path:t.routeConfig.path,pathMatch:t.routeConfig.pathMatch,redirectTo:t.routeConfig.redirectTo,outlet:t.routeConfig.outlet}:null,queryParams:t.queryParams,queryParamMap:t.queryParamMap,fragment:t.fragment,component:t.routeConfig?t.routeConfig.component:void 0,root:void 0,parent:void 0,firstChild:r[0],pathFromRoot:void 0,children:r}},t}(),c=function(){return(c=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},p=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},l=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,i,n=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(o=n.next()).done;)a.push(o.value)}catch(t){i={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(i)throw i.error}}return a};(n=t.NavigationActionTiming||(t.NavigationActionTiming={}))[n.PreActivation=1]="PreActivation",n[n.PostActivation=2]="PostActivation";var g,f=new e.InjectionToken("@ngrx/router-store Internal Configuration"),h=new e.InjectionToken("@ngrx/router-store Configuration"),d="router";function v(e){return c({stateKey:d,serializer:u,navigationActionTiming:t.NavigationActionTiming.PreActivation},e)}!function(t){t[t.NONE=1]="NONE",t[t.ROUTER=2]="ROUTER",t[t.STORE=3]="STORE"}(g||(g={}));var R={},y=function(){function n(t,e,r,o,i){this.store=t,this.router=e,this.serializer=r,this.errorHandler=o,this.config=i,this.lastEvent=null,this.trigger=g.NONE,this.stateKey=this.config.stateKey,this.setUpStoreStateListener(),this.setUpRouterEventsListener()}var d,y;return d=n,n.forRoot=function(t){return void 0===t&&(t={}),{ngModule:d,providers:[{provide:f,useValue:t},{provide:s,useClass:t.serializer?t.serializer:u}]}},n.prototype.setUpStoreStateListener=function(){var t=this;this.store.pipe(o.select(this.stateKey),i.withLatestFrom(this.store)).subscribe(function(e){var r=l(e,2);t.navigateIfNeeded(r[0],r[1])})},n.prototype.navigateIfNeeded=function(t,e){var o=this;if(t&&t.state&&this.trigger!==g.ROUTER&&!(this.lastEvent instanceof r.NavigationStart)){var i=t.state.url;this.router.url!==i&&(this.storeState=e,this.trigger=g.STORE,this.router.navigateByUrl(i).catch(function(t){o.errorHandler.handleError(t)}))}},n.prototype.setUpRouterEventsListener=function(){var e,o=this,n=this.config.navigationActionTiming===t.NavigationActionTiming.PostActivation;this.router.events.pipe(i.withLatestFrom(this.store)).subscribe(function(t){var i=l(t,2),a=i[0],s=i[1];o.lastEvent=a,a instanceof r.NavigationStart?(o.routerState=o.serializer.serialize(o.router.routerState.snapshot),o.trigger!==g.STORE&&(o.storeState=s,o.dispatchRouterRequest(a))):a instanceof r.RoutesRecognized?(e=a,n||o.trigger===g.STORE||o.dispatchRouterNavigation(a)):a instanceof r.NavigationCancel?(o.dispatchRouterCancel(a),o.reset()):a instanceof r.NavigationError?(o.dispatchRouterError(a),o.reset()):a instanceof r.NavigationEnd&&(o.trigger!==g.STORE&&(n&&o.dispatchRouterNavigation(e),o.dispatchRouterNavigated(a)),o.reset())})},n.prototype.dispatchRouterRequest=function(t){this.dispatchRouterAction("@ngrx/router-store/request",{event:t})},n.prototype.dispatchRouterNavigation=function(t){var e=this.serializer.serialize(t.state);this.dispatchRouterAction("@ngrx/router-store/navigation",{routerState:e,event:new r.RoutesRecognized(t.id,t.url,t.urlAfterRedirects,e)})},n.prototype.dispatchRouterCancel=function(t){this.dispatchRouterAction("@ngrx/router-store/cancel",{storeState:this.storeState,event:t})},n.prototype.dispatchRouterError=function(t){this.dispatchRouterAction(a,{storeState:this.storeState,event:new r.NavigationError(t.id,t.url,""+t)})},n.prototype.dispatchRouterNavigated=function(t){var e=this.serializer.serialize(this.router.routerState.snapshot);this.dispatchRouterAction("@ngrx/router-store/navigated",{event:t,routerState:e})},n.prototype.dispatchRouterAction=function(t,e){this.trigger=g.ROUTER;try{this.store.dispatch({type:t,payload:c({routerState:this.routerState},e)})}finally{this.trigger=g.NONE}},n.prototype.reset=function(){this.trigger=g.NONE,this.storeState=null,this.routerState=null},d=function(t,e,r,o){var i,n=arguments.length,a=n<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,o);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(n<3?i(a):n>3?i(e,r,a):i(e,r))||a);return n>3&&a&&Object.defineProperty(e,r,a),a}([e.NgModule({providers:[{provide:f,useValue:R},{provide:h,useFactory:v,deps:[f]},{provide:s,useClass:u}]}),(4,y=e.Inject(h),function(t,e){y(t,e,4)}),p("design:paramtypes",[o.Store,r.Router,s,e.ErrorHandler,Object])],n)}();t.ɵngrx_modules_router_store_router_store_a=f,t.ɵngrx_modules_router_store_router_store_b=v,t.ROUTER_ERROR=a,t.ROUTER_CANCEL="@ngrx/router-store/cancel",t.ROUTER_NAVIGATION="@ngrx/router-store/navigation",t.ROUTER_NAVIGATED="@ngrx/router-store/navigated",t.ROUTER_REQUEST="@ngrx/router-store/request",t.routerReducer=function E(t,e){var r=e;switch(r.type){case"@ngrx/router-store/navigation":case a:case"@ngrx/router-store/cancel":return{state:r.payload.routerState,navigationId:r.payload.event.id};default:return t}},t.StoreRouterConnectingModule=y,t.ROUTER_CONFIG=h,t.DEFAULT_ROUTER_FEATURENAME=d,t.RouterStateSerializer=s,t.DefaultRouterStateSerializer=u,Object.defineProperty(t,"__esModule",{value:!0})});